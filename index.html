<script>
  async function findAccount() {
    const grade = document.getElementById('grade').value;
    const cls = document.getElementById('class').value;
    const number = document.getElementById('number').value;
    const site = document.getElementById('site').value;

    const resultDiv = document.getElementById('result');
    resultDiv.textContent = '';

    if (!grade || !cls || !number || !site) {
        resultDiv.innerHTML = '<p class="error">모든 항목을 선택해주세요.</p>';
        return;
    }

    const studentId = `${grade}${cls}${number}`;

    // 사이트 키와 실제 이름 매핑
    const siteNames = {
        google: "구글",
        lms: "리로스쿨",
        onehour: "원아워-영어",
        mathholic: "매쓰홀릭-수학",
        elice: "엘리스코딩-정보"
    };

    try {
        const response = await fetch('students.csv'); // CSV 파일 경로
        const csvText = await response.text();
        const rows = csvText.split('\n').map(row => row.split(','));

        const headers = rows[0];
        const data = rows.slice(1);

        const siteIndex = headers.indexOf(site);

        if (siteIndex === -1) {
            resultDiv.innerHTML = '<p class="error">해당 사이트 데이터가 없습니다.</p>';
            return;
        }

        const student = data.find(row => row[0] === studentId);

        if (!student) {
            resultDiv.innerHTML = '<p class="error">학번을 확인 후 다시 시도해주세요.</p>';
            return;
        }

        const siteName = siteNames[site]; // 매핑된 사이트 이름 가져오기
        resultDiv.innerHTML = `<p>너의 <strong>${siteName}</strong> 아이디는: <br><strong>${student[siteIndex]}</strong></p>`;
    } catch (error) {
        console.error('Error loading CSV:', error);
        resultDiv.innerHTML = '<p class="error">계정을 가져오는 중 오류가 발생했습니다.</p>';
    }
}
</script>
